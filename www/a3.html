<!DOCTYPE html PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="GENERATOR" content="Mozilla/4.77 [en] (X11; U; Linux
      2.4.9-6 i686) [Netscape]">
    <title>CS 410 - Assignment 3</title>
  </head>
  <body bgcolor="#ffffff" text="#000000">
    &nbsp;
    <table nosave="" border="0" width="95%">
      <tbody>
        <tr nosave="">
          <td style="font-weight: bold;" nosave="" width="28%">CS 410</td>
          <td style="font-weight: bold;" width="44%">
            <center>Systems Programming</center>
          </td>
          <td style="font-weight: bold;" nosave="" width="28%">
            <center>Instructor: Richard West <br>
            </center>
          </td>
        </tr>
        <tr>
          <td colspan="3">
            <center><u><font size="+3">Assignment 3</font></u></center>
          </td>
        </tr>
      </tbody>
    </table>
    <hr align="center">
    <h2><u>Purpose</u></h2>
    <br>
    There are two parts to this assignment: a mandatory part and an
    optional bonus part. For the mandatory part, you will be required to
    write a C/C++ program that implements a web server. Your web server
    will conform to HTTP/1.x for the purposes of client requests, and
    you will need to process client <span style="font-family: Courier
      New,Courier,monospace;">HTTP GET</span> requests for web pages
    hosted on the server machine.<br>
    You will need to use sockets to implement the communication between
    a client on one machine and the server on either the same or a
    remote machine.<br>
    <br>
    For the bonus part, described in more detail below, you will be
    required to add functionality to your web server to support
    interaction with a physical device. Although most (all?) of the
    assignments in Computer Science seem to treat computing in an
    abstract way, there are many cases where computers interact with the
    physical world through a collection of sensors and actuators. This
    forms a <i>physical computing</i> environment. To address this
    problem, you will be asked <br>
    <h1 style="text-decoration: underline;">Mandatory: Web server</h1>
    <h2 style="text-decoration: underline;">The Basic HTTP Protocol</h2>
    The basic structure of interaction between a web client and web
    server is as follows:<br>
    <br>
    <span style="font-style: italic;">Client sends request</span> (from
    a suitable browser)<br>
    <span style="font-family: Courier New,Courier,monospace;">GET
      filename HTTP/version</span><br style="font-family: Courier
      New,Courier,monospace;">
    <span style="font-family: Courier New,Courier,monospace;">optional
      arguments</span><br style="font-family: Courier
      New,Courier,monospace;">
    <span style="font-family: Courier New,Courier,monospace;">a blank
      line</span><br>
    <br>
    <span style="font-style: italic;">Server sends reply</span><br>
    <span style="font-family: Courier New,Courier,monospace;">HTTP/version









      status-code status-message</span><br style="font-family: Courier
      New,Courier,monospace;">
    <span style="font-family: Courier New,Courier,monospace;">additional
      information</span><br style="font-family: Courier
      New,Courier,monospace;">
    <span style="font-family: Courier New,Courier,monospace;">a blank
      line</span><br style="font-family: Courier New,Courier,monospace;">
    <span style="font-family: Courier New,Courier,monospace;">content</span><br>
    <br>
    You will need to ensure the information sent back from the server is
    formatted as described above.<br>
    The additional information send back in a server reply is of the
    form:<br>
    <br>
    Content-type:&nbsp; xxx/yyy&nbsp;&nbsp; where xxx/yyy can be:<br>
    &nbsp;&nbsp;&nbsp; text/plain<br>
    &nbsp;&nbsp;&nbsp; text/html<br>
    &nbsp;&nbsp;&nbsp; image/gif<br>
    &nbsp;&nbsp;&nbsp; image/jpeg<br>
    &nbsp;&nbsp;&nbsp; <br>
    <h2 style="text-decoration: underline;">The Server</h2>
    You can assume the server <span style="font-style: italic;">forks</span>
    a child process for each incoming request. Additionally, you can
    assume each request involves establishing a new connection with the
    server, rather than maintaining any notion of a <span style="font-style: italic;">session</span> for multiple requests.
    You should write your web server in a file called <span style="font-family: Courier New,Courier,monospace;">webserv.c</span>.
    For execution, you should <span style="font-style: italic;">bind</span>
    the server to a specific <span style="font-style: italic;">port</span>.<span style="font-style: italic;"> </span>To run your web server you
    should type:<br>
    <br>
    <span style="font-family: Courier New,Courier,monospace;">$./webserv
      port-number</span><br>
    <br>
    where <span style="font-family: Courier New,Courier,monospace;">port-number</span>
    should be a value in the range 5000-65536 such as 8080.<br>
    <br>
    The server will be required to handle a series of requests, such as
    listing the contents of a directory on the server machine,
    retrieving a file for viewing on the client, and running cgi
    scripts. In particular, you will be required to handle static and
    dynamic content requests. In the former case, the content is simply
    retrieved from a pre-existing file on the server. For dynamic
    content, you will be expected to run a program on the server, to
    process data and generate an HTML compliant file for sending back to
    the client.<br>
    <br>
    Your web server should handle HTML status codes 200 (successful
    request), 404 (Not Found), and 501(Not Implemented). For status code
    501, the server does not recognize the request method. Further
    information about status codes can be found <a href="http://www.w3.org/Protocols/rfc2616/rfc2616.html">here</a>.<br>
    <h2 style="text-decoration: underline;">The Client</h2>
    <br>
    The client can be any web browser of your choice. Your requests from
    the client should be in the form:<br>
    <br>
    <span style="font-family: Courier New,Courier,monospace;">http://ip.address.of.server:port-number/request</span><br>
    <br>
    <span style="font-family: Courier New,Courier,monospace;">ip.address.of.server</span>
    -- this is the IP address of the server machine <br>
    <span style="font-family: Courier New,Courier,monospace;">port-number</span>
    -- this is the numeric port on which the server listens. Together
    with the IP address, this identifies an end-point of communication
    (or socket) to which the client connects.<br>
    <br>
    <span style="font-family: Courier New,Courier,monospace;">request</span>
    -- this is either a subdirectory on the server that you wish to
    list, the name of a html file, or a cgi file. In the latter case,
    this will be a reference to a script on the server that you must
    execute to perform some command. The content of a cgi script, such
    as test.cgi, must be set executable on the server and must refer to
    a shell or Perl script such as the following:<br>
    <br>
    test.cgi (set executable using chmod 755 test.cgi):<br>
    <br>
    #!/bin/sh<br>
    # test.cgi -- a simple test<br>
    printf "Content-type: text/plain\n\nThis is a test!\n"<br>
    <br>
    To execute a Perl script, you can issue a request such as:<br>
    <br>
    <span style="font-family: Courier New,Courier,monospace;">http://ip.address.of.server:port-number/request.cgi<br>
      <br>
      <span style="font-family: serif;">where request.cgi is an
        executable Perl script on the server having contents such as:<br>
        <br>
        #!/usr/bin/perl&nbsp; <br>
        # perl-test.cgi -- a simple Perl script test<br>
        print "Content-type: text/plain\n\nThis is a Perl test!\n";<br>
      </span></span>
    <h2 style="text-decoration: underline;">Basic Test Cases</h2>
    <ul>
      <li>You should be able to support all the following test cases:</li>
      <ul>
        <li>A request for a directory listing</li>
        <li>A request for a valid (and non-existing) html file. NOTE: A
          non-existent request corresponds to an HTTP error <a href="http://www.w3.org/Protocols/rfc2616/rfc2616.html">status








            code</a> of 404. <br>
        </li>
        <li>A request for a static image (in either gif or jpeg format,
          having a file ending of .gif, .jpg or .jpeg)</li>
        <li>A request for a cgi script that requires execution of a
          basic shell command, executed using <span style="font-style:
            italic;">sh</span></li>
        <li><span style="font-style: italic;"><span style="font-family:
              serif;"></span></span><span style="font-family: serif;">A
            request for a perl script in a cgi file to process raw data
            and format it into an html file. You can find information on
            the correct format of an HTML file <a href="http://www.w3.org/TR/html401/struct/global.html">here.</a></span><span style="font-style: italic;"><a href="http://www.w3.org/TR/html401/struct/global.html"><span style="font-family: serif;"></span></a></span></li>
        <li><span style="font-style: italic;"><span style="font-family:
              serif;"></span></span><span style="font-family: serif;">A
            request for a dynamically-created image using gnuplot on the
            server. Information about gnuplot can be found at: </span><a href="http://www.gnuplot.info/">http://www.gnuplot.info/</a></li>
      </ul>
    </ul>
    For the latter case, above, you can assume the request specifies a
    cgi file describing a perl script. The perl script will process data
    as described in the next subsection.<br>
    <h3>Dynamic Content using Gnuplot<br>
    </h3>
    In this case, you are required to execute a program on the server
    called my-histogram, as follows:<br>
    <br>
    <span style="font-family: Courier New,Courier,monospace;">$my-histogram





      file pattern1 pattern2 ... patternN</span><br>
    <br>
    file specifies the name of a file you wish to search for all
    occurrences of a given regular-expression pattern or string
    sequence.&nbsp; For example:<br>
    <br>
    <span style="font-family: Courier New,Courier,monospace;">$my-histogram





      file "and" "but" "so" "he.*lo" </span><br>
    <br>
    will tally all occurrences of the words "and", "but" and "so" in <span style="font-family: Courier New,Courier,monospace;">file</span>,
    along with all strings that match the pattern "he.*lo" such as
    "hello" etc. You can assume all regular-expression patterns that are
    acceptable to grep -e are valid. You can assume the number of
    pattern arguments is limited to 5.<br>
    &nbsp;<br>
    Once <span style="font-family: Courier New,Courier,monospace;">my-histogram</span>
    has tallied all occurrences of the matching strings for each
    pattern, you should plot the results as a histogram using <span style="font-family: Courier New,Courier,monospace;">gnuplot. </span>You





    can pipe the output of <span style="font-family: Courier
      New,Courier,monospace;">my-histogram</span> to <span style="font-family: Courier New,Courier,monospace;">gnuplot</span>
    using a Perl command as follows:
    <center>
      <p><span style="font-family: Courier New,Courier,monospace;">open
          (GNUPLOT, "|gnuplot");</span> # Notice the vertical bar for a
        pipe</p>
    </center>
    <p>After which piping commands to <span style="font-family: Courier
        New,Courier,monospace;">gnuplot</span> is analogous to writing
      to a file.<br>
    </p>
    <p><span style="font-family: Courier New,Courier,monospace;">my-histogram</span>
      can be written in any language you choose, including C/C++, Perl,
      etc. You are also free to use shell commands such as "grep -e" if
      you wish, or the built-in Perl regular expression features. You
      should format the output of your <span style="font-family:
        Courier New,Courier,monospace;">gnuplot</span> histogram, to
      show "frequency" up the y-axis and the labelled patterns on the
      x-axis, so there is one frequency bar per pattern. Once you have
      done this, you should command <span style="font-family: Courier
        New,Courier,monospace;">gnuplot</span> to output the histogram
      to a file that records the information in gif or jpeg format.
      After this, you need your cgi script to send your <span style="font-family: Courier New,Courier,monospace;">gnuplot</span>
      gif or jpeg image back to the client for viewing. <br>
    </p>
    <h3>Pretty Printed Output</h3>
    <p>Just as this webpage has been formatted using html, you should
      write an executable on the server that is invoked as part of your
      CGI script to pretty-print your histogram. Specifically, you are
      to embed the histogram image file in a HTML page that has a 16pt
      RED font title and white background*. The title should read:
      "CS410 Webserver". The title should be centered on the page. Below
      it, should be a blank line (spacing of which is your choosing)
      followed by the histogram, which is also centered. *If you so
      wish, you can experiment with the generated HTML content,
      producing image backgrounds and additional details. The base case
      should be formatted as described, however.<br>
    </p>
    <h2><u>Advanced Features</u></h2>
    <p>If you manage to complete the above parts of the assignment, you
      should consider these more advanced features. Extra credit will be
      given if you tackle one or more of the following:<br>
    </p>
    <ul>
      <li><b>A multi-threaded web server.</b> Instead of using fork()
        calls for each client request, you should instead spawn a thread
        using your own thread creation routines, based on the
        sigaltstack() method. Specifically, you should *not* use
        make/get/set/swapcontext() functions or any pre-existing thread
        packages (e.g., pthreads). Instead, you should write your own
        thread management code, which can be based on your solution from
        the previous assignment.</li>
      <li><b>A web cache.</b> In this part of the assignment, you should
        develop a method to cache files in RAM for subsequent requests.
        The RAM cache should be a pool of memory of some defined size.
        You should set this to be a tunable parameter from 4KB-2MB. Upon
        initialization, the cache is empty, but gets filled for each
        file request until it is full. At that point you can adopt a
        simple replacement strategy of your choice (e.g.,
        first-in-first-out, random, or least-recently used). You must
        specify your replacement method in a README file. To make the
        cache beneficial, you should support requests that are both in
        the server's filesystem and also on a remote host. Client
        requests should provide an optional argument to indicate the
        remote host location for files that are not stored in the
        server's local filesystem. To test this feature, you should have
        the server act like a client for a remote host machine, thereby
        retrieving the necessary file(s) for placement in the web cache.
        In turn, these files will be relayed back to the original
        client.</li>
      <li><b>Server configuration. </b>For testing purposes, you should
        provide a way to disable the above advanced features, so that
        the web server falls back to operating in normal mode (without
        web caching and threads). This means you should produce only one
        version of your code. To enable/disable features of your server,
        you can either use a configuration script, pass in command-line
        arguments, or (worst-case) use defined constants within your
        code. <br>
      </li>
    </ul>
    <h1><u>Optional: Physical Computing</u></h1>
    <p>This part of the assignment will be given a maximum 50% bonus.
      The actual value of this part of the assignment is
      50%*(mandatory_score), where mandatory_score is the grade you get
      for the web server part of the assignment, discounting the
      advanced features. <br>
    </p>
    <p>To tackle this part of the assignment requires you to have access
      to an Arduino Uno or similar Arduino-compatible device. These can
      be purchased for about $5.99 (roughly the price of two coffees)
      from places such as <a href="http://www.microcenter.com/product/431997/Uno_R3_MainBoard">Microcenter</a>.You
      can also buy a good quality starter kit from <a href="http://www.amazon.com/SainSmart-New-Basic-Starter-Arduino/dp/B00UV7KAPM/ref=sr_1_12?ie=UTF8&amp;qid=1447801842&amp;sr=8-12&amp;keywords=arduino+uno+kit">Amazon</a>,
      which is a little more expensive but includes everything to get
      going with some basic building projects. If you have access to a
      Raspberry Pi or other similar single board computer, you can use
      that too. <br>
    </p>
    <p>The idea: as a way to introduce you to physical computing, you
      are allowed to be creative for this optional part of the
      assignment. One idea would be to have an Arduino board connected
      via a serial interface to a server PC running the web server you
      have created. A client would initiate requests to your web server,
      which then issued serial commands to your Arduino board. Your
      Arduino board would run some code (of your choosing) to perform a
      control operation. For example, a simple control operation would
      be to turn on/off some LEDs, or to control the speed/angle of a
      stepper or servo motor. All these operations would be triggered by
      client requests via a web browser, through which commands are sent
      via your web server. <br>
    </p>
    <p>Another option would be to simply use a web interface to submit
      requests to upload Arduino "sketches" to your target device. Here,
      a sketch is a simple program that runs out of the ROM space on the
      Arduino itself. To learn more about Arduinos, you can look <a href="https://www.arduino.cc/">here</a>. The Arduino IDE is open
      source and can be downloaded for most OSes, and there is a
      reference guide to explain the simple programming language
      available online. <br>
    </p>
    <h2>Why tackle the optional part of the assignment?<br>
    </h2>
    <p>Aside from having the opportunity to gain extra credit, you also
      get to work with physical devices which is a lot of fun. It makes
      computing feel "real" rather than abstract. Writing programs that
      make computers work is one thing, but having those computers
      control devices is the basis for how robots, 3D printers, UAVs and
      all sorts of physical devices operate. Where possible, we will try
      to provide resources that you can borrow, but you are encouraged
      to invest a small fee in purchasing equipment that will
      potentially prove extremely valuable in the long run. The costs
      are, for the most part, less than the price of a text book! <br>
    </p>
    <p>This part of the assignment also allows you to be creative. You
      can come up with any physical computing problem of your own
      choosing, as long as the control is initiated through the web
      server. You will be asked to demonstrate this part of the
      assignment either in a demo time slot, or in a group setting to
      the rest of the class (time permitting). If you plan to do the
      optional part I ask that before the assignment deadline, you send
      me an email with a few sentences of what you plan to do. <br>
    </p>
    <ul>
    </ul>
    <p> </p>
    <h2> <span style="text-decoration: underline;">Submission</span><br>
    </h2>
    Work is to be submitted using gsubmit. Please submit only the source
    files in a directory called <span style="font-family: Courier
      New,Courier,mono;">webserv</span>. Also, submit a makefile that
    compiles and links your sources into an executable called <span style="font-family: Courier New,Courier,mono;">webserv</span>. Do
    not include any other test files. Your code will be tested on the
    undergraduate lab machines, or on your own laptop. You can work in
    groups of UP TO TWO people and you will be expected to demo your
    code for the grader/TF. <br>
    <br>
    <div style="text-align: center;">********************************************







      <br>
    </div>
    You are required to submit your work by the posted deadline on the
    class website. You will subsequently be expected to spend 15 minutes
    demo-ing your work in a designated time slot. We will provide
    instructions at a later date about demo-ing your project. ALL
    MEMBERS OF A TEAM MUST BE PRESENT AT THE DEMO. <br>
    <h2><u>Grading <br>
      </u></h2>
    <table border="1" width="100%" cellpadding="2" cellspacing="2">
      <tbody>
        <tr>
          <td valign="top">
            <ul>
              <li>Basic test cases for static content (including
                directory listings, correct error reporting, static
                images and cgi scripts)</li>
              <ul>
                <li>This should include correct usage of sockets to
                  enable client requests and correct handling of HTML
                  client request formats<br>
                </li>
              </ul>
            </ul>
          </td>
          <td valign="top">60 points<br>
          </td>
        </tr>
        <tr>
          <td valign="top">
            <ul>
              <li>Dynamic content including regular expression handling
                and histogram/gnuplot generation<br>
              </li>
            </ul>
          </td>
          <td valign="top">30 points<br>
          </td>
        </tr>
        <tr>
          <td valign="top">
            <ul>
              <li>Pretty printed output, including correct embedding of
                images in HTML-formatted files<br>
              </li>
            </ul>
          </td>
          <td valign="top">10 points<br>
          </td>
        </tr>
        <tr>
          <td valign="top">
            <ul>
              <li>Advanced features -- thread management<br>
              </li>
            </ul>
          </td>
          <td valign="top">10 points<br>
          </td>
        </tr>
        <tr>
          <td valign="top">
            <ul>
              <li>Advanced features -- web cache (including proxy
                support for remote requests and cache replacement)<br>
              </li>
            </ul>
          </td>
          <td valign="top">25 points<br>
          </td>
        </tr>
        <tr>
          <td valign="top">
            <ul>
              <li>Server configuration</li>
              <ul>
                <li>Program style and documentation (in a README file)<br>
                </li>
              </ul>
            </ul>
          </td>
          <td valign="top">5 points<br>
          </td>
        </tr>
      </tbody>
    </table>
    <ul>
      <li>The mandatory part of the assignment adds up to 100%,
        discounting the advanced features and server configuration. </li>
      <li>The optional physical computing part of the assignment will be
        worth up to 50% of your mandatory part.</li>
    </ul>
    <h2><u>Academic Conduct Reminder</u></h2>
    Submitting part or all of another person's assignment (or leveraging
    another person's work to produce your own submission) is an act of
    plagiarism. Submissions will be checked for originality by hand and
    by a program checker -- please do not jeopardize your academic
    standing by taking chances in completing this assignment. Please
    come see me if you have any questions about where I (and the
    college) draw the line regarding acceptable levels of collaboration.
  

</body></html>